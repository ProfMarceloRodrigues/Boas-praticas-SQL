--Boas  Práticas  de SQL
--Nivel Avançado -Para quem que  ir para um  proximo nivel

--1.Não use UPDATE ou  DELETE sempre  where - sempre  revise 

select * from  DimCustomer
where CustomerKey =1

update DimCustomer
set FirstName='Rodrigo'

where CustomerKey = 1


delete from DimCustomer
where CustomerKey=378


--2.Use  LIMIT com ORDER BY da  forma certa para evitar  resultados aleatorios 

select top 5
CustomerKey,
Gender,
YearlyIncome

from DimCustomer
order by YearlyIncome desc

--3. Separe  consultas  em blocos  reutilizaveis  com VIEWS ( quando  possivel)

select Top 100
FirstName,
EmailAddress,
YearlyIncome
from DimCustomer
order by  YearlyIncome desc

create view top100clientes as
select Top 100
c.CustomerKey as 'Codigo_Cliente',
c.YearlyIncome as 'Renda'

from  DimCustomer c
order by  YearlyIncome desc

select 
*
from top100clientes

--4. Filtrar  depois  de  agrupar  é  diferente   de  agrupar   depois  de  filtrar


select 
Education,
COUNT(*) as Total
from DimCustomer
where Gender ='M'
group by Education

select 
Education,Gender,
COUNT(*) as Total
from DimCustomer
group by Education, Gender

having Gender ='M'


--5. Você  pode  colocar  um  select  dentro  de  outro (Subconsulta) no lugar  de  valores  fixos


select *
 from  DimProduct
 where UnitPrice >= 356.8301

 select AVG(UnitPrice) from DimProduct

 select *
 from  DimProduct
 where UnitPrice >=(select AVG(UnitPrice) from DimProduct)

 ---Feliz  ano pra  vocEs
